<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Test Demo - Derechos Humanos</title>
<style>
  body { font-family: sans-serif; background: #f0fdf4; margin: 0; padding: 2rem; color: #1f2937; }
  h2 { text-align: center; color: #065f46; }
  .question { margin-bottom: 2rem; background: #fff; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
  .options { margin-top: 1rem; }
  .option { display: block; margin-bottom: 0.5rem; }
  button { margin-top: 1rem; padding: 0.75rem 1.5rem; background: #2563eb; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
  button:hover { background: #1d4ed8; }
  .result { font-weight: bold; font-size: 1.25rem; text-align: center; margin-top: 2rem; }
  .justification { margin-top: 0.5rem; color: #374151; font-size: 0.95rem; }
  .correct { color: green; }
  .incorrect { color: red; }
</style>
</head>
<body>
<h2>Test de Derechos Humanos (Demo)</h2>
<div class="config">
<label for="numPreguntas"><strong>Número de preguntas:</strong></label>
<select id="numPreguntas">
<option value="1">1</option>
<option value="2">2</option>
<option value="3" selected>3</option>
</select>
<button onclick="cargarTest()" type="button">Comenzar</button>
</div>

<form id="testForm"></form>
<div class="result" id="testResult"></div>

<script>
const preguntasBanco = [
  {
    pregunta: "¿Cuál de los siguientes es un derecho fundamental?",
    opciones: ["a) Derecho a la vivienda", "b) Derecho a un medio ambiente sano", "c) Derecho a la libertad ideológica", "d) Derecho al trabajo"],
    correcta: "c) Derecho a la libertad ideológica",
    justificacion: "La libertad ideológica está recogida como derecho fundamental en el artículo 16 de la Constitución."
  },
  {
    pregunta: "¿Cuál es el objetivo principal de los derechos humanos?",
    opciones: ["a) Promover el comercio", "b) Garantizar la seguridad jurídica", "c) Proteger la dignidad humana", "d) Controlar la inmigración"],
    correcta: "c) Proteger la dignidad humana",
    justificacion: "La base de los derechos humanos es la dignidad inherente a todos los seres humanos."
  },
  {
    pregunta: "¿Qué organización internacional promueve los derechos humanos a nivel global?",
    opciones: ["a) OTAN", "b) ONU", "c) FMI", "d) OMC"],
    correcta: "b) ONU",
    justificacion: "La ONU tiene organismos dedicados a la defensa de los derechos humanos como el Consejo de Derechos Humanos."
  }
];

function barajar(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

function cargarTest() {
  const seleccionadas = [...preguntasBanco];
  barajar(seleccionadas);
  const num = parseInt(document.getElementById("numPreguntas").value);
  const seleccion = seleccionadas.slice(0, num);
  const testForm = document.getElementById("testForm");
  testForm.innerHTML = '';

  seleccion.forEach((preg, index) => {
    const id = `q${index}`;
    const opciones = [...preg.opciones];
    barajar(opciones);
    const opcionesHTML = opciones.map(op => `
      <label class="option">
        <input type="radio" name="${id}" value="${op}" data-correcta="${preg.correcta}" data-justificacion="${preg.justificacion}">
        ${op}
      </label>
    `).join('');
    testForm.innerHTML += `
      <div class="question" id="${id}Box">
        <p><strong>${index + 1}.</strong> ${preg.pregunta}</p>
        <div class="options">${opcionesHTML}</div>
        <div class="justification" id="j${id}"></div>
      </div>
    `;
  });

  testForm.innerHTML += '<div style="text-align:center;"><button type="button" onclick="corregir()">✅ Enviar</button></div>';
}

function corregir() {
  const preguntas = document.querySelectorAll('.question');
  let aciertos = 0;

  preguntas.forEach((q, index) => {
    const seleccion = q.querySelector('input[type="radio"]:checked');
    const justificacionDiv = q.querySelector('.justification');

    if (seleccion) {
      if (seleccion.value === seleccion.dataset.correcta) {
        aciertos++;
        justificacionDiv.innerHTML = `<span class="correct">✔ ${seleccion.dataset.justificacion}</span>`;
      } else {
        justificacionDiv.innerHTML = `<span class="incorrect">✘ ${seleccion.dataset.justificacion}</span>`;
      }
    } else {
      justificacionDiv.innerHTML = `<span class="incorrect">✘ No contestada</span>`;
    }
  });

  document.getElementById('testResult').innerText =
    `Has acertado ${aciertos} de ${preguntas.length}`;
}
</script>
</body>
</html>
