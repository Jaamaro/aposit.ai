<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test de Ministerio de Interior y Defensa</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #f5f7fb;
      --card: #ffffff;
      --text: #111827;
      --muted: #6b7280;
      --primary: #2563eb;
      --primary-dark: #1e40af;
      --success: #059669;
      --danger: #dc2626;
      --ring: rgba(37, 99, 235, 0.25);
    }
    * { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; }
    body {
      font-family: 'Roboto', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      padding: 24px;
    }
    .container {
      max-width: 960px;
      margin: 0 auto;
    }
    header.hero {
      text-align: center;
      margin-bottom: 16px;
    }
    .title {
      font-size: 32px;
      font-weight: 800;
      color: var(--primary-dark);
      margin: 0 0 8px;
    }
    .subtitle {
      color: var(--muted);
      margin: 0;
    }
    .controls {
      background: var(--card);
      border-radius: 14px;
      box-shadow: 0 10px 20px rgba(0,0,0,0.06);
      padding: 16px;
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
      justify-content: center;
      position: sticky;
      top: 12px;
      z-index: 5;
    }
    .controls label { font-weight: 500; }
    select {
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid #e5e7eb;
      background: #fff;
      outline: none;
      transition: box-shadow .2s, border-color .2s;
    }
    select:focus { border-color: var(--primary); box-shadow: 0 0 0 4px var(--ring); }

    .btn {
      cursor: pointer;
      border: none;
      border-radius: 10px;
      padding: 12px 18px;
      font-weight: 700;
      transition: transform .15s, background .2s, box-shadow .2s;
      color: #fff;
      background: var(--primary);
      box-shadow: 0 6px 14px rgba(37,99,235,.2);
    }
    .btn:hover { transform: translateY(-1px); background: var(--primary-dark); }
    .btn.secondary { background: #6b7280; }
    .btn.secondary:hover { background: #374151; }
    .btn.success { background: var(--success); }
    .btn.success:hover { background: #047857; }
    .btn.danger { background: var(--danger); }
    .btn.danger:hover { background: #b91c1c; }

    .progress {
      width: 100%;
      height: 10px;
      background: #e5e7eb;
      border-radius: 999px;
      overflow: hidden;
      margin-top: 8px;
    }
    .progress-bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, var(--primary), #60a5fa);
      transition: width .3s ease;
    }

    .question {
      margin: 14px 0;
      padding: 18px;
      background: var(--card);
      border-radius: 14px;
      box-shadow: 0 10px 20px rgba(0,0,0,0.06);
    }
    .q-head {
      display: flex;
      align-items: baseline;
      gap: 8px;
    }
    .q-num {
      font-weight: 800;
      color: var(--primary-dark);
    }
    .q-text { margin: 0; }

    .options { margin-top: 10px; display: grid; gap: 8px; }
    .option {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid #e5e7eb;
      background: #fff;
      transition: background .15s, border-color .15s, box-shadow .15s;
      cursor: pointer;
    }
    .option input { transform: scale(1.2); }
    .option:hover { background: #f9fafb; border-color: #d1d5db; }
    .option.is-selected { box-shadow: 0 0 0 4px var(--ring); border-color: var(--primary); }

    .justification {
      margin-top: 10px; color: var(--muted);
    }
    .correct { color: var(--success); font-weight: 700; }
    .incorrect { color: var(--danger); font-weight: 700; }

    .option.correct-option {
      border-color: rgba(5,150,105,.4);
      background: #ecfdf5;
    }
    .option.wrong-option {
      border-color: rgba(220,38,38,.4);
      background: #fef2f2;
    }

    .result-card {
      margin: 18px 0;
      padding: 16px;
      background: var(--card);
      border-radius: 14px;
      box-shadow: 0 10px 20px rgba(0,0,0,0.06);
      text-align: center;
    }
    .score {
      font-size: 22px;
      font-weight: 800;
      margin: 8px 0;
    }
    .muted { color: var(--muted); }
    footer { text-align: center; margin-top: 24px; color: var(--muted); }
  </style>
</head>
<body>
  <div class="container">
    <header class="hero">
      <h1 class="title">Test de Ministerio de Interior y Defensa</h1>
      <p class="subtitle">Selecciona cu√°ntas preguntas quieres y pulsa <strong>Comenzar</strong>.</p>
    </header>

    <div class="controls">
      <label for="numPreguntas">N√∫mero de preguntas:</label>
      <select id="numPreguntas">
        <option value="10">10</option>
        <option value="20">20</option>
        <option value="30">30</option>
        <option value="40">40</option>
        <option value="50" selected>50</option>
      </select>
      <button class="btn" type="button" onclick="cargarTest()">Comenzar</button>
      <button class="btn secondary" type="button" onclick="reiniciarTest()">Reiniciar</button>
      <div class="progress" style="flex-basis: 100%;">
        <div class="progress-bar" id="progressBar"></div>
      </div>
    </div>

    <form id="testForm"></form>

    <div id="testResult"></div>
    <footer>¬© Test de pr√°ctica ‚Äî Ministerio de Interior y Defensa</footer>
  </div>

<script>
const preguntasBanco = [
  {
    "pregunta": "Seg√∫n el Real Decreto 829/2023, ¬øqui√©n tiene la competencia para crear, modificar y suprimir los departamentos ministeriales?",
    "opciones": [
      "a) El Presidente del Gobierno mediante Orden Ministerial.",
      "b) El Consejo de Ministros mediante Real Decreto.",
      "c) El Presidente del Gobierno mediante Real Decreto.",
      "d) El Congreso de los Diputados mediante Ley Org√°nica."
    ],
    "correcta": "c) El Presidente del Gobierno mediante Real Decreto.",
    "justificacion": "As√≠ lo establece el art. 2.2.j) de la Ley 50/1997 citada en el RD 829/2023."
  },
  {
    "pregunta": "¬øCu√°l de los siguientes no es un departamento ministerial seg√∫n el RD 829/2023?",
    "opciones": [
      "a) Ministerio de Defensa.",
      "b) Ministerio de la Presidencia, Justicia y Relaciones con las Cortes.",
      "c) Ministerio de Asuntos Sociales y Agenda 2030.",
      "d) Ministerio del Interior."
    ],
    "correcta": "c) Ministerio de Asuntos Sociales y Agenda 2030.",
    "justificacion": "Ese nombre no figura entre los 22 ministerios establecidos por el RD 829/2023."
  },
  {
    "pregunta": "El Ministerio del Interior se estructura, seg√∫n el RD 1009/2023, en los siguientes √≥rganos superiores y directivos:",
    "opciones": [
      "a) Secretar√≠a de Estado de Seguridad, Secretar√≠a General T√©cnica y Subsecretar√≠a del Interior.",
      "b) Secretar√≠a General de Instituciones Penitenciarias, Secretar√≠a General T√©cnica y Direcci√≥n General de Tr√°fico.",
      "c) Secretar√≠a de Estado de Seguridad, Secretar√≠a General de Instituciones Penitenciarias y Subsecretar√≠a del Interior.",
      "d) Direcci√≥n General de la Guardia Civil, Direcci√≥n General de Pol√≠tica Interior y Direcci√≥n General de Instituciones Penitenciarias."
    ],
    "correcta": "c) Secretar√≠a de Estado de Seguridad, Secretar√≠a General de Instituciones Penitenciarias y Subsecretar√≠a del Interior.",
    "justificacion": "Estos son los √≥rganos superiores b√°sicos que se mencionan expresamente en el art√≠culo 5 del RD 1009/2023."
  },
  {
    "pregunta": "¬øCu√°l de los siguientes √≥rganos directivos depende de la Secretar√≠a General de Instituciones Penitenciarias?",
    "opciones": [
      "a) Direcci√≥n General de Ejecuci√≥n Penal y Reinserci√≥n Social.",
      "b) Direcci√≥n General de Coordinaci√≥n y Estudios.",
      "c) Direcci√≥n General de Protecci√≥n Civil y Emergencias.",
      "d) Direcci√≥n General de Instituciones Penitenciarias."
    ],
    "correcta": "a) Direcci√≥n General de Ejecuci√≥n Penal y Reinserci√≥n Social.",
    "justificacion": "Es el √≥rgano √∫nico que depende de dicha Secretar√≠a General."
  },
  {
    "pregunta": "Seg√∫n el art√≠culo 23 del RD 1009/2023, ¬øcu√°l es el m√°ximo n√∫mero de asesores en el gabinete de un ministro que no sea vicepresidente?",
    "opciones": [
      "a) 3 asesores con nivel de subdirector general.",
      "b) 5 asesores con nivel org√°nico de subdirecci√≥n general.",
      "c) 7 asesores, uno de ellos con rango de direcci√≥n general.",
      "d) 9 asesores, uno de ellos con rango de vicesecretar√≠a."
    ],
    "correcta": "b) 5 asesores con nivel org√°nico de subdirecci√≥n general.",
    "justificacion": "As√≠ se establece en el art. 23.2 del RD 1009/2023."
  },
  {
    "pregunta": "¬øCu√°l de las siguientes NO es funci√≥n atribuida a la Secretar√≠a de Estado de Seguridad seg√∫n el RD 207/2024?",
    "opciones": [
      "a) Direcci√≥n y coordinaci√≥n de la cooperaci√≥n policial internacional.",
      "b) Ejercicio del mando de las Fuerzas y Cuerpos de Seguridad del Estado.",
      "c) Planificaci√≥n de las pol√≠ticas de desarrollo rural en materia de seguridad.",
      "d) Direcci√≥n del Sistema Nacional de Protecci√≥n de Infraestructuras Cr√≠ticas."
    ],
    "correcta": "c) Planificaci√≥n de las pol√≠ticas de desarrollo rural en materia de seguridad.",
    "justificacion": "Esta competencia no aparece en el RD 207/2024."
  },
  {
    "pregunta": "La Oficina de Comunicaci√≥n del Ministerio del Interior tiene nivel org√°nico de:",
    "opciones": [
      "a) Subsecretar√≠a.",
      "b) Subdirecci√≥n general.",
      "c) Direcci√≥n general.",
      "d) Direcci√≥n Adjunta."
    ],
    "correcta": "b) Subdirecci√≥n general.",
    "justificacion": "As√≠ lo establece el art√≠culo 1.4 del RD 207/2024."
  },
  {
    "pregunta": "¬øCu√°l de los siguientes √≥rganos depende directamente de la Secretar√≠a de Estado de Seguridad?",
    "opciones": [
      "a) Gabinete del Ministro del Interior.",
      "b) Centro de Coordinaci√≥n Operativa de Seguridad Interior (CECOIN).",
      "c) Centro de Inteligencia contra el Terrorismo y el Crimen Organizado (CITCO).",
      "d) Direcci√≥n General de Pol√≠tica Interior."
    ],
    "correcta": "c) Centro de Inteligencia contra el Terrorismo y el Crimen Organizado (CITCO).",
    "justificacion": "El art√≠culo 2.03 del RD 207/2024 se√±ala esta dependencia."
  },
  {
    "pregunta": "El CITCO tiene entre sus competencias:",
    "opciones": [
      "a) Elaborar informes mensuales sobre amenazas.",
      "b) Desarrollar estrategias nacionales de seguridad cibern√©tica.",
      "c) Establecer criterios de coordinaci√≥n operativa de las FFCCSE.",
      "d) Custodiar documentos clasificados de la UE."
    ],
    "correcta": "c) Establecer criterios de coordinaci√≥n operativa de las FFCCSE.",
    "justificacion": "Aparece expresamente entre las funciones del CITCO, seg√∫n art√≠culo 2.03 del RD 207/2024."
  },
  {
    "pregunta": "¬øCu√°l de los siguientes no es un √≥rgano directivo de la Secretar√≠a de Estado de Seguridad?",
    "opciones": [
      "a) Direcci√≥n General de Coordinaci√≥n y Estudios.",
      "b) Direcci√≥n General de la Polic√≠a.",
      "c) Direcci√≥n General de Protecci√≥n Internacional.",
      "d) Direcci√≥n General de Relaciones Internacionales y Extranjer√≠a."
    ],
    "correcta": "c) Direcci√≥n General de Protecci√≥n Internacional.",
    "justificacion": "Esta direcci√≥n depende de la Subsecretar√≠a del Interior, no de la SES."
  },
  {
    "pregunta": "¬øQu√© rango org√°nico tiene el titular de la Direcci√≥n General de la Guardia Civil?",
    "opciones": [
      "a) Rango de Subsecretario.",
      "b) Rango de Secretario de Estado.",
      "c) Rango de Director General.",
      "d) Rango de Secretario General."
    ],
    "correcta": "a) Rango de Subsecretario.",
    "justificacion": "As√≠ se establece en el art. 4 del RD 207/2024."
  },
  {
    "pregunta": "La Junta de Gobierno de la Direcci√≥n General de la Polic√≠a se encuentra en el nivel:",
    "opciones": [
      "a) Perif√©rico.",
      "b) Central.",
      "c) Operativo.",
      "d) Consultivo."
    ],
    "correcta": "b) Central.",
    "justificacion": "Se menciona como √≥rgano en el nivel central en el art. 3.06 del RD 207/2024."
  },
  {
    "pregunta": "¬øCu√°ntas comisar√≠as generales existen en el nivel central de la Polic√≠a Nacional seg√∫n el RD 207/2024?",
    "opciones": [
      "a) 3",
      "b) 4",
      "c) 5",
      "d) 6"
    ],
    "correcta": "c) 5",
    "justificacion": "Son las comisar√≠as generales de Informaci√≥n, Polic√≠a Judicial, Seguridad Ciudadana, Extranjer√≠a y Fronteras, y Polic√≠a Cient√≠fica."
  },
  {
    "pregunta": "En el nivel perif√©rico de la Guardia Civil, ¬øcu√°l de los siguientes no forma parte de la estructura?",
    "opciones": [
      "a) Zonas de la Guardia Civil.",
      "b) Jefaturas Superiores.",
      "c) Mando de Fronteras y Polic√≠a Mar√≠tima.",
      "d) Jefatura de Unidades Especiales y de Reserva."
    ],
    "correcta": "b) Jefaturas Superiores.",
    "justificacion": "Las Jefaturas Superiores son parte de la estructura perif√©rica de la Polic√≠a Nacional, no de la Guardia Civil."
  },
  {
    "pregunta": "Seg√∫n el RD 207/2024, ¬øqu√© √≥rgano coordina el Comit√© Ejecutivo de Coordinaci√≥n?",
    "opciones": [
      "a) Direcci√≥n General de Coordinaci√≥n y Estudios.",
      "b) Secretar√≠a de Estado de Seguridad.",
      "c) Subsecretar√≠a del Interior.",
      "d) Gabinete del Ministro."
    ],
    "correcta": "b) Secretar√≠a de Estado de Seguridad.",
    "justificacion": "Es presidido por la persona titular de la SES, seg√∫n el art. 2.04."
  },
  {
    "pregunta": "¬øEn qu√© art√≠culo del RD 207/2024 se regulan las funciones generales del Ministerio del Interior?",
    "opciones": [
      "a) Art√≠culo 1.",
      "b) Art√≠culo 2.",
      "c) Art√≠culo 5.",
      "d) Disposici√≥n adicional primera."
    ],
    "correcta": "a) Art√≠culo 1.",
    "justificacion": "El art√≠culo 1 define la organizaci√≥n general del Departamento."
  },
  {
    "pregunta": "¬øCu√°l de las siguientes es una competencia espec√≠fica del Ministerio del Interior seg√∫n el art√≠culo 1.01 del RD 207/2024?",
    "opciones": [
      "a) Propuesta de la pol√≠tica exterior.",
      "b) Direcci√≥n de protecci√≥n civil y emergencias.",
      "c) Coordinaci√≥n de las Fuerzas Armadas.",
      "d) Gesti√≥n de sistemas de justicia."
    ],
    "correcta": "b) Direcci√≥n de protecci√≥n civil y emergencias.",
    "justificacion": "Es una competencia mencionada expl√≠citamente en el art√≠culo 1.01."
  },
  {
    "pregunta": "El Director del Gabinete de la Secretar√≠a de Estado de Seguridad ejerce adem√°s las funciones de:",
    "opciones": [
      "a) Relator Nacional contra la Trata de Seres Humanos.",
      "b) Secretario General de Instituciones Penitenciarias.",
      "c) Coordinador del Consejo de Pol√≠tica Interior.",
      "d) Director del CITCO."
    ],
    "correcta": "a) Relator Nacional contra la Trata de Seres Humanos.",
    "justificacion": "As√≠ lo recoge el art√≠culo 2.02 del RD 207/2024."
  },
  {
    "pregunta": "¬øCu√°l de las siguientes opciones corresponde a una Subdirecci√≥n General dependiente de la Secretar√≠a de Estado de Seguridad?",
    "opciones": [
      "a) Subdirecci√≥n General de Protecci√≥n Internacional.",
      "b) Subdirecci√≥n General de Planificaci√≥n y Gesti√≥n de Infraestructuras y Medios para la Seguridad.",
      "c) Subdirecci√≥n General de Recursos Humanos.",
      "d) Subdirecci√≥n General de Asistencia Jur√≠dica."
    ],
    "correcta": "b) Subdirecci√≥n General de Planificaci√≥n y Gesti√≥n de Infraestructuras y Medios para la Seguridad.",
    "justificacion": "Esta Subdirecci√≥n depende directamente de la SES, seg√∫n art. 2.05."
  },
  {
    "pregunta": "La Direcci√≥n General de la Guardia Civil depende org√°nicamente de:",
    "opciones": [
      "a) La Secretar√≠a de Estado de Seguridad.",
      "b) El Ministerio de Defensa.",
      "c) El Ministerio del Interior.",
      "d) El Consejo de Ministros."
    ],
    "correcta": "a) La Secretar√≠a de Estado de Seguridad.",
    "justificacion": "Es el √≥rgano del que depende directamente seg√∫n el art. 4 del RD 207/2024."
  },
  {
    "pregunta": "La Subdirecci√≥n General de Sistemas de Informaci√≥n y Comunicaciones para la Seguridad se encarga de:",
    "opciones": [
      "a) La supervisi√≥n e inspecci√≥n de instituciones penitenciarias.",
      "b) Estandarizar sistemas de informaci√≥n y comunicaciones.",
      "c) Dirigir los centros de control penitenciario.",
      "d) Gestionar operaciones policiales internacionales."
    ],
    "correcta": "b) Estandarizar sistemas de informaci√≥n y comunicaciones.",
    "justificacion": "Esta funci√≥n aparece en el art. 2.05 del RD 207/2024."
  },
{
  pregunta: "¬øCu√°l de los siguientes es un √≥rgano dependiente de la Subsecretar√≠a del Interior seg√∫n el RD 207/2024?",
  opciones: [
    "a) Direcci√≥n General de Coordinaci√≥n y Estudios.",
    "b) Direcci√≥n General de Pol√≠tica Interior.",
    "c) Direcci√≥n General de Relaciones Internacionales y Extranjer√≠a.",
    "d) Direcci√≥n General de la Guardia Civil."
  ],
  correcta: "b) Direcci√≥n General de Pol√≠tica Interior.",
  justificacion: "La Direcci√≥n General de Pol√≠tica Interior depende de la Subsecretar√≠a del Interior seg√∫n el Art. 1.05.C del RD 207/2024."
},
{
  pregunta: "¬øCu√°l es el n√∫mero m√°ximo de asesores permitidos en los gabinetes de las Secretar√≠as de Estado seg√∫n el art√≠culo 23.3 del RD 1009/2023?",
  opciones: [
    "a) 5 asesores con rango de subdirecci√≥n general.",
    "b) 3 asesores con nivel org√°nico de subdirecci√≥n general.",
    "c) 7 asesores con nivel org√°nico de subdirecci√≥n general.",
    "d) 4 asesores con rango de direcci√≥n general."
  ],
  correcta: "b) 3 asesores con nivel org√°nico de subdirecci√≥n general.",
  justificacion: "Seg√∫n el art. 23.3 del RD 1009/2023, los gabinetes de las Secretar√≠as de Estado cuentan con m√°ximo tres asesores con nivel de subdirecci√≥n general."
},
{
  pregunta: "El art√≠culo 1.02 del RD 207/2024 atribuye al Ministro del Interior la direcci√≥n de:",
  opciones: [
    "a) Todas las Fuerzas Armadas y Cuerpos de Seguridad.",
    "b) Las competencias del Ministerio en materia de Administraci√≥n Penitenciaria.",
    "c) Las competencias del Consejo de Pol√≠tica Nuclear.",
    "d) Las pol√≠ticas de igualdad en materia de diversidad."
  ],
  correcta: "b) Las competencias del Ministerio en materia de Administraci√≥n Penitenciaria.",
  justificacion: "El art√≠culo 1.02 recoge esta funci√≥n como parte de la direcci√≥n del Ministerio del Interior."
},
{
  pregunta: "¬øQu√© √≥rgano ejerce el mando superior de las Fuerzas y Cuerpos de Seguridad del Estado seg√∫n el RD 207/2024?",
  opciones: [
    "a) La Subsecretar√≠a del Interior.",
    "b) La Secretar√≠a de Estado de Seguridad.",
    "c) El Ministro del Interior.",
    "d) La Direcci√≥n General de la Guardia Civil."
  ],
  correcta: "c) El Ministro del Interior.",
  justificacion: "Seg√∫n el art√≠culo 1.02 del RD 207/2024, el Ministro del Interior ejerce el mando superior."
},
{
  pregunta: "¬øCu√°l de las siguientes funciones NO corresponde a la Subdirecci√≥n General de Planificaci√≥n y Gesti√≥n de Infraestructuras y Medios para la Seguridad?",
  opciones: [
    "a) Controlar y coordinar la ejecuci√≥n de programas derivados de compromisos internacionales.",
    "b) Gestionar el patrimonio inmobiliario de la seguridad.",
    "c) Elaborar informes anuales sobre banda ancha de emergencia.",
    "d) Proponer proyectos y obras para infraestructuras de seguridad."
  ],
  correcta: "c) Elaborar informes anuales sobre banda ancha de emergencia.",
  justificacion: "Esta funci√≥n no aparece en el listado del art. 2.05 del RD 207/2024."
},
{
  pregunta: "La Direcci√≥n General de Coordinaci√≥n y Estudios depende de:",
  opciones: [
    "a) La Secretar√≠a General T√©cnica.",
    "b) La Secretar√≠a de Estado de Seguridad.",
    "c) La Subsecretar√≠a del Interior.",
    "d) La Secretar√≠a General de Instituciones Penitenciarias."
  ],
  correcta: "b) La Secretar√≠a de Estado de Seguridad.",
  justificacion: "Esta direcci√≥n depende directamente de la SES, seg√∫n el art. 1.05A del RD 207/2024."
},
{
  pregunta: "¬øCu√°l de los siguientes √≥rganos pertenece al √°mbito de la Direcci√≥n General de la Guardia Civil?",
  opciones: [
    "a) Subdirecci√≥n General de Recursos Humanos.",
    "b) Mando de Fronteras y Polic√≠a Mar√≠tima.",
    "c) Comisar√≠a General de Extranjer√≠a.",
    "d) Divisi√≥n de Cooperaci√≥n Internacional."
  ],
  correcta: "b) Mando de Fronteras y Polic√≠a Mar√≠tima.",
  justificacion: "Este √≥rgano est√° previsto en la estructura de la Guardia Civil seg√∫n sus competencias territoriales."
},
{
  pregunta: "La Direcci√≥n General de la Polic√≠a tiene el rango de:",
  opciones: [
    "a) Secretar√≠a de Estado.",
    "b) Secretar√≠a General.",
    "c) Subsecretar√≠a.",
    "d) Subdirecci√≥n General."
  ],
  correcta: "c) Subsecretar√≠a.",
  justificacion: "El art. 3.01 del RD 207/2024 fija que el titular tiene rango de Subsecretario."
},
{
  pregunta: "La Divisi√≥n Econ√≥mica y T√©cnica de la Polic√≠a Nacional se encarga de:",
  opciones: [
    "a) Gestionar los recursos humanos.",
    "b) Gestionar la documentaci√≥n de extranjeros.",
    "c) Adquirir equipamientos t√©cnicos.",
    "d) Planificar operativos en materia de extranjer√≠a."
  ],
  correcta: "c) Adquirir equipamientos t√©cnicos.",
  justificacion: "Seg√∫n el art. 3.05 del RD 207/2024 es una de sus competencias."
},
{
  pregunta: "¬øCu√°l es el nivel org√°nico del Centro Tecnol√≥gico de Seguridad (CETSE)?",
  opciones: [
    "a) Direcci√≥n General.",
    "b) Subdirecci√≥n General.",
    "c) No tiene rango org√°nico propio.",
    "d) Direcci√≥n Adjunta."
  ],
  correcta: "b) Subdirecci√≥n General.",
  justificacion: "Forma parte de la Subdirecci√≥n General de Sistemas de Informaci√≥n y Comunicaciones para la Seguridad."
},
{
  pregunta: "¬øA qu√© √≥rgano compete la direcci√≥n y coordinaci√≥n de las relaciones con el Comit√© Europeo para la Prevenci√≥n de la Tortura?",
  opciones: [
    "a) Direcci√≥n General de Protecci√≥n Internacional.",
    "b) Secretar√≠a de Estado de Seguridad.",
    "c) Direcci√≥n General de Coordinaci√≥n y Estudios.",
    "d) Gabinete del Ministro del Interior."
  ],
  correcta: "b) Secretar√≠a de Estado de Seguridad.",
  justificacion: "As√≠ lo recoge el art. 2.01.I del RD 207/2024."
},
{
  pregunta: "¬øCu√°l es la funci√≥n principal de la Comisar√≠a General de Informaci√≥n?",
  opciones: [
    "a) Prever y coordinar los escenarios de emergencia en territorios rurales.",
    "b) Captar, tratar y explotar informaci√≥n para la seguridad p√∫blica.",
    "c) Gestionar las entradas y salidas de extranjeros.",
    "d) Regular el juego y las apuestas ilegales."
  ],
  correcta: "b) Captar, tratar y explotar informaci√≥n para la seguridad p√∫blica.",
  justificacion: "Esto se menciona como funci√≥n esencial de la Comisar√≠a de Informaci√≥n (art. 3.03.A RD 207/2024)."
},
{
  pregunta: "¬øCu√°l es el √≥rgano encargado de gestionar las campa√±as institucionales de publicidad del Ministerio del Interior?",
  opciones: [
    "a) Gabinete del Ministro.",
    "b) Gabinete de la Secretar√≠a de Estado.",
    "c) Oficina de Comunicaci√≥n.",
    "d) Direcci√≥n General de Coordinaci√≥n y Estudios."
  ],
  correcta: "c) Oficina de Comunicaci√≥n.",
  justificacion: "El art. 1.04 del RD 207/2024 menciona esta funci√≥n expresamente."
},
{
  pregunta: "¬øQui√©n preside el Comit√© Ejecutivo de Coordinaci√≥n?",
  opciones: [
    "a) La persona titular del Ministerio del Interior.",
    "b) El director del Gabinete del Ministro.",
    "c) El titular de la Secretar√≠a de Estado de Seguridad.",
    "d) El Director General de la Polic√≠a."
  ],
  correcta: "c) El titular de la Secretar√≠a de Estado de Seguridad.",
  justificacion: "Seg√∫n art. 2.04 del RD 207/2024."
},
{
  pregunta: "¬øCu√°l de las siguientes funciones NO corresponde al CITCO seg√∫n el RD 207/2024?",
  opciones: [
    "a) Evaluaci√≥n peri√≥dica de la amenaza terrorista.",
    "b) Definir estructuras de datos para el sistema penitenciario.",
    "c) Establecimiento de criterios de actuaci√≥n operativa.",
    "d) Punto nacional de contacto en inteligencia criminal estrat√©gica."
  ],
  correcta: "b) Definir estructuras de datos para el sistema penitenciario.",
  justificacion: "Esa funci√≥n no figura entre las atribuidas al CITCO, seg√∫n art. 2.03."
},
{
  pregunta: "La Subdirecci√≥n General de Recursos Humanos y Formaci√≥n pertenece a:",
  opciones: [
    "a) Direcci√≥n General de la Guardia Civil.",
    "b) Direcci√≥n General de la Polic√≠a.",
    "c) Secretar√≠a de Estado de Seguridad.",
    "d) Subsecretar√≠a del Interior."
  ],
  correcta: "b) Direcci√≥n General de la Polic√≠a.",
  justificacion: "As√≠ se establece en el art. 3.02 del RD 207/2024."
},
{
  pregunta: "¬øCu√°l de los siguientes objetivos est√° relacionado con el Sistema Nacional de Protecci√≥n de Infraestructuras Cr√≠ticas?",
  opciones: [
    "a) Coordinar las actuaciones en materia de extranjer√≠a y fronteras.",
    "b) Establecer los criterios y actuaciones en la lucha contra la trata.",
    "c) Gestionar la protecci√≥n de instalaciones sensibles frente a amenazas.",
    "d) Supervisar las empresas de seguridad privada."
  ],
  correcta: "c) Gestionar la protecci√≥n de instalaciones sensibles frente a amenazas.",
  justificacion: "Es una funci√≥n atribuida a la SES seg√∫n el art. 2.01.M del RD 207/2024."
},
{
  pregunta: "¬øQu√© √≥rgano tiene competencia en el desarrollo de programas de infraestructura financiados con fondos europeos?",
  opciones: [
    "a) Subdirecci√≥n General de Planificaci√≥n y Gesti√≥n de Infraestructuras.",
    "b) Direcci√≥n General de Protecci√≥n Civil y Emergencias.",
    "c) Direcci√≥n General de Instituciones Penitenciarias.",
    "d) Subdirecci√≥n General de Innovaci√≥n y Cooperaci√≥n Judicial."
  ],
  correcta: "a) Subdirecci√≥n General de Planificaci√≥n y Gesti√≥n de Infraestructuras.",
  justificacion: "Esta funci√≥n se establece en el art. 2.05.A.05 del RD 207/2024."
},
{
  pregunta: "La Direcci√≥n General de Protecci√≥n Internacional se encarga de la:",
  opciones: [
    "a) Gesti√≥n administrativa de los procesos electorales.",
    "b) Coordinaci√≥n de los servicios penitenciarios.",
    "c) Aplicaci√≥n del r√©gimen de protecci√≥n de refugiados y ap√°tridas.",
    "d) Direcci√≥n operativa de las unidades antiterroristas."
  ],
  correcta: "c) Aplicaci√≥n del r√©gimen de protecci√≥n de refugiados y ap√°tridas.",
  justificacion: "As√≠ se recoge en el art. 1.05.C.02 del RD 207/2024."
},
{
  pregunta: "¬øCu√°l de las siguientes NO es una funci√≥n de la Direcci√≥n General de la Polic√≠a?",
  opciones: [
    "a) Proponer a la Secretar√≠a de Estado proyectos operativos.",
    "b) Coordinar la protecci√≥n de altas personalidades en el √°mbito nacional.",
    "c) Dirigir el control de entrada y salida de extranjeros.",
    "d) Gestionar la expedici√≥n del DNI y pasaportes."
  ],
  correcta: "c) Dirigir el control de entrada y salida de extranjeros.",
  justificacion: "Esta funci√≥n corresponde a la Comisar√≠a General de Extranjer√≠a y Fronteras."
},
{
  pregunta: "¬øCu√°l de las siguientes unidades depende de la Direcci√≥n Adjunta Operativa de la Polic√≠a Nacional?",
  opciones: [
    "a) Divisi√≥n de Personal.",
    "b) Comisar√≠a General de Seguridad Ciudadana.",
    "c) Direcci√≥n General de Pol√≠tica Interior.",
    "d) Subdirecci√≥n General de Protecci√≥n Internacional."
  ],
  correcta: "b) Comisar√≠a General de Seguridad Ciudadana.",
  justificacion: "Forma parte de las unidades operativas bajo la DAO (art. 3.03)."
},

];

let totalPreguntasRenderizadas = 0;

function barajar(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

function setProgress(current, total) {
  const bar = document.getElementById('progressBar');
  const pct = total > 0 ? Math.round((current / total) * 100) : 0;
  bar.style.width = pct + '%';
  bar.title = pct + '%';
}
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

// Carga el test con preguntas y respuestas aleatorias
function cargarTest() {
  const numPreguntas = parseInt(document.getElementById('numPreguntas').value);
  const testForm = document.getElementById('testForm');
  const progressBar = document.getElementById('progressBar');
  const testResult = document.getElementById('testResult');

  testForm.innerHTML = '';
  testResult.innerHTML = '';
  progressBar.style.width = '0%';

  if (!preguntasBanco || preguntasBanco.length === 0) {
    testForm.innerHTML = '<p style="color:red;font-weight:bold;">‚ö†Ô∏è No hay preguntas en el banco.</p>';
    return;
  }

  const letras = ['a)', 'b)', 'c)', 'd)', 'e)', 'f)']; // por si hay m√°s de 4 opciones
  const preguntasSeleccionadas = shuffle([...preguntasBanco]).slice(0, numPreguntas);

  preguntasSeleccionadas.forEach((preguntaObj, index) => {
    // Mezclamos las opciones (pero vamos a limpiar su prefijo "a) " si lo llevan)
    const opcionesMezcladas = shuffle([...preguntaObj.opciones]);

    // Convertimos cada opci√≥n en un objeto { texto, esCorrecta }
    const opcionesObj = opcionesMezcladas.map(opcion => {
      // Limpiar prefijos como "a) ", "b) " si existen
      const textoLimpio = opcion.replace(/^[A-Za-z]\)\s*/, '').trim();
      const esCorrecta = opcion === preguntaObj.correcta || textoLimpio === preguntaObj.correcta.replace(/^[A-Za-z]\)\s*/, '').trim();
      return { texto: textoLimpio, esCorrecta };
    });

    // Renderizamos las opciones asignando letras seg√∫n la posici√≥n (letras fijas)
    const opcionesHTML = opcionesObj.map((opt, optIndex) => {
      const marcaCorrecta = opt.esCorrecta ? 'true' : 'false';
      const letra = letras[optIndex] || `${optIndex + 1})`; // fallback si hay >6 opciones
      // No incluimos la letra dentro del texto de la opci√≥n; la mostramos separada
      return `
        <label class="option">
          <input type="radio" name="pregunta${index}" value="${opt.texto.replace(/"/g, '&quot;')}" data-correct="${marcaCorrecta}">
          <span style="font-weight:700; margin-right:10px; color:var(--muted)">${letra}</span>
          ${opt.texto}
        </label>
      `;
    }).join('');

    const preguntaHTML = `
      <div class="question">
        <div class="q-head">
          <span class="q-num">${index + 1}.</span>
          <p class="q-text">${preguntaObj.pregunta}</p>
        </div>
        <div class="options">
          ${opcionesHTML}
        </div>
        <div class="justification muted" style="display:none;">
          <span class="correct">‚úî ${preguntaObj.correcta.replace(/^[A-Za-z]\)\s*/, '')}</span><br>
          ${preguntaObj.justificacion}
        </div>
      </div>
    `;
    testForm.insertAdjacentHTML('beforeend', preguntaHTML);
  });

  // A√±adir bot√≥n corregir (evitar duplicados)
  const botonCorregirExistente = Array.from(testForm.getElementsByTagName('button')).find(b => b.textContent === 'Corregir');
  if (!botonCorregirExistente) {
    const botonCorregir = document.createElement('button');
    botonCorregir.type = 'button';
    botonCorregir.className = 'btn success';
    botonCorregir.textContent = 'Corregir';
    botonCorregir.onclick = () => corregirTest();
    testForm.appendChild(botonCorregir);
  }
}


function corregirTest() {
  const preguntas = document.querySelectorAll('.question');
  let aciertos = 0;

  preguntas.forEach((pregunta) => {
    const radios = pregunta.querySelectorAll('input[type="radio"]');
    const labels = pregunta.querySelectorAll('.option');
    const justificacion = pregunta.querySelector('.justification');
    let seleccionCorrecta = false;

    // Limpiar clases anteriores
    labels.forEach(l => {
      l.classList.remove('correct-option', 'wrong-option');
      const checkmark = l.querySelector('.checkmark');
      if (checkmark) checkmark.remove();
    });

    radios.forEach(radio => {
      const label = radio.closest('.option');
      if (radio.checked && radio.dataset.correct === 'true') {
        seleccionCorrecta = true;
      }
    });

    radios.forEach(radio => {
      const label = radio.closest('.option');

      if (radio.dataset.correct === 'true') {
        // Mostrar check verde en la opci√≥n correcta
        label.classList.add('correct-option');
        label.insertAdjacentHTML('afterbegin', `<span class="checkmark" style="color:#059669;font-weight:700;">‚úî</span>`);
      }

      if (radio.checked && radio.dataset.correct !== 'true') {
        // Mostrar X roja en la opci√≥n elegida incorrecta
        label.classList.add('wrong-option');
        label.insertAdjacentHTML('afterbegin', `<span class="checkmark" style="color:#dc2626;font-weight:700;">‚úò</span>`);
      }
    });

    // Mostrar la justificaci√≥n al final
    if (justificacion) {
      justificacion.style.display = 'block';
      justificacion.innerHTML = `
        ${seleccionCorrecta 
          ? `<span class="correct">‚úî ${pregunta.querySelector('input[data-correct="true"]').value}</span><br>` 
          : `<span class="incorrect">‚úò ${pregunta.querySelector('input[data-correct="true"]').value}</span><br>`
        }
        ${pregunta.querySelector('.justification').textContent || ''}
      `;
    }

    if (seleccionCorrecta) aciertos++;
  });

  // Mostrar resultado final
  const total = preguntas.length;
  const porcentaje = Math.round((aciertos / total) * 100);
  const testResult = document.getElementById('testResult');
  testResult.innerHTML = `
    <div class="result-card">
      <p class="score">Has acertado ${aciertos} de ${total} preguntas (${porcentaje}%).</p>
      <p class="muted">${porcentaje >= 70 ? "‚úÖ ¬°Buen trabajo!" : "‚ùå Puedes mejorar."}</p>
    </div>
  `;
  document.getElementById('progressBar').style.width = '100%';
}


function reiniciarTest() {
  document.getElementById('testForm').innerHTML = '';
  document.getElementById('testResult').innerHTML = '';
  setProgress(0, 0);
}
  // ==========================
// üîπ TEMPORIZADOR CONFIGURABLE
// ==========================

// Variables del temporizador
let tiempoTotal = 0;
let tiempoRestante = 0;
let temporizadorInterval;

// Crear selector de tiempo en el panel de controles
const selectTiempo = document.createElement('select');
selectTiempo.id = 'tiempoSeleccionado';
selectTiempo.innerHTML = `
  <option value="0">Sin l√≠mite</option>
  <option value="5">5 minutos</option>
  <option value="10" selected>10 minutos</option>
  <option value="15">15 minutos</option>
  <option value="20">20 minutos</option>
  <option value="30">30 minutos</option>
  <option value="40">40 minutos</option>
  <option value="50">50 minutos</option>
  <option value="60">60 minutos</option>
`;
const labelTiempo = document.createElement('label');
labelTiempo.htmlFor = 'tiempoSeleccionado';
labelTiempo.textContent = 'Tiempo l√≠mite:';
const controlsDiv = document.querySelector('.controls');
controlsDiv.insertBefore(labelTiempo, controlsDiv.children[2]);
controlsDiv.insertBefore(selectTiempo, controlsDiv.children[3]);

// Crear elemento visual del temporizador
const temporizadorDiv = document.createElement('div');
temporizadorDiv.id = 'temporizador';
temporizadorDiv.style.textAlign = 'center';
temporizadorDiv.style.fontSize = '18px';
temporizadorDiv.style.fontWeight = '700';
temporizadorDiv.style.color = '#2563eb';
temporizadorDiv.style.marginTop = '12px';
controlsDiv.appendChild(temporizadorDiv);

// Mostrar tiempo en formato mm:ss
function mostrarTiempo() {
  let min = Math.floor(tiempoRestante / 60);
  let seg = tiempoRestante % 60;
  temporizadorDiv.textContent = `‚è≥ Tiempo restante: ${min}:${seg.toString().padStart(2, '0')}`;
}

// Iniciar temporizador
function iniciarTemporizador() {
  const minutosSeleccionados = parseInt(document.getElementById('tiempoSeleccionado').value);
  if (minutosSeleccionados === 0) {
    temporizadorDiv.textContent = '‚è≥ Sin l√≠mite de tiempo';
    return;
  }

  tiempoTotal = minutosSeleccionados * 60;
  tiempoRestante = tiempoTotal;
  mostrarTiempo();

  temporizadorInterval = setInterval(() => {
    tiempoRestante--;
    mostrarTiempo();
    if (tiempoRestante <= 0) {
      clearInterval(temporizadorInterval);
      temporizadorDiv.textContent = '‚è∞ ¬°Tiempo agotado!';
      finalizarTestPorTiempo();
    }
  }, 1000);
}

// Detener temporizador
function detenerTemporizador() {
  clearInterval(temporizadorInterval);
}

// Modificar funci√≥n cargarTest para que inicie el temporizador
const originalCargarTest = cargarTest;
cargarTest = function() {
  originalCargarTest();
  detenerTemporizador(); // Por si se reinicia
  iniciarTemporizador();
};

// Al finalizar el test manualmente (bot√≥n Enviar)
const originalEvaluarTest = evaluarTest;
evaluarTest = function() {
  detenerTemporizador(); // Detiene el contador al pulsar Enviar
  originalEvaluarTest();
};

// Cuando el tiempo se agota autom√°ticamente
function finalizarTestPorTiempo() {
  // Evita ejecuciones dobles
  if (window.__finalizadoPorTiempo__) return;
  window.__finalizadoPorTiempo__ = true;

  detenerTemporizador();
  if (temporizadorDiv) temporizadorDiv.textContent = '‚è∞ ¬°Tiempo agotado! Pulsa "Enviar" para corregir.';

  // üîí Bloquear todas las respuestas
  document.querySelectorAll('input[type="radio"]').forEach(r => {
    r.disabled = true;
    const opt = r.closest('.option');
    if (opt) {
      opt.style.opacity = '0.6';
      opt.style.pointerEvents = 'none';
    }
  });

  // ‚úÖ Dejar el bot√≥n "Enviar" activo y hacerlo destacar en verde
  const btnEnviar = document.querySelector('button.btn.success, button[type="submit"]');
  if (btnEnviar) {
    btnEnviar.disabled = false;
    btnEnviar.style.opacity = '1';
    btnEnviar.style.cursor = 'pointer';

    // üíö Efecto parpadeo verde suave
    btnEnviar.style.animation = 'blinkGreen 1.2s infinite';
    btnEnviar.style.transition = 'background-color 0.3s ease';
    btnEnviar.style.backgroundColor = '#22c55e'; // verde suave (Tailwind: green-500)
    btnEnviar.style.color = 'white';

    // Inyectar animaci√≥n CSS si no existe
    if (!document.getElementById('blinkGreen-style')) {
      const style = document.createElement('style');
      style.id = 'blinkGreen-style';
      style.textContent = `
        @keyframes blinkGreen {
          0%, 100% { background-color: #22c55e; }
          50% { background-color: #86efac; } /* verde claro (green-300) */
        }
      `;
      document.head.appendChild(style);
    }
  }

  // üîÑ Mantener bot√≥n "Reiniciar" activo
  const btnReiniciar = document.querySelector('button.btn.secondary');
  if (btnReiniciar) {
    btnReiniciar.disabled = false;
  }
}
</script>
</body>
</html>
